--------------------------------------------------------
--  File created - Wednesday-May-01-2019   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Table EMPLOYEES
--------------------------------------------------------

  CREATE TABLE "PRCS251E"."EMPLOYEES" 
   (	"EMPLOYEE_ID" VARCHAR2(15 BYTE), 
	"EMPLOYEE_HASHED_PASSWORD" VARCHAR2(100 BYTE), 
	"PASSWORD_SALT" VARCHAR2(100 BYTE), 
	"FIRST_NAME" VARCHAR2(35 BYTE), 
	"LAST_NAME" VARCHAR2(35 BYTE), 
	"JOB_ROLE" VARCHAR2(15 BYTE)
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
REM INSERTING into PRCS251E.EMPLOYEES
SET DEFINE OFF;
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1006','1d5871891e33e43b4e62f4542c56d481127df13b5af6d4f6dcbd9b8c2de81b6f','uVc129CuiVdRF/K8hNujrfY82xh2L1azmFvUTH0pRe8=','John','Smith','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('A1019','5e1fb713f3b30045e62326657722ce36ccbd48d47aa4bc01e92b448faca0026c','1IrGVS+2H+AKZpx6+V0FeuyAWyB55XwAN4OceG5XxO4=','John','Doe','Administrator');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1020','5bf4a98d8090c01823c4c08c4a93ec2e633c2375415b60393ec21cbfa897f931','MzV4A6qWmZLUmkPWg1HqAUrQY6VeLls5vR2N2fYLZ64=','Sean','Popek','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1021','a02a00ceb6d871c9ff0bff2fcd1d33e1a1af533055d38ab6ecc7c83ac95798e9','LBwJUPVqMFnOwBlpFIilmakgz7kTEz/J5OkhSxKhwLo=','Roy','Lopiccolo','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1022','90595165aa9f00650b9897b4ed77a859d9d968499db28492821dd532e20664c8','0Z02Xlm3y/6miFOtw+prfoXa/C7fBJ14OogQ18W2x5c=','Gil','Mirando','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1023','1c913048f5946aa21e6f175307dee7db4661a2585c1fb4741df9e2a9b92986df','rbCaqYQS1dQByliLUKKekVFOEmAEZZlA0qYp4TCC4dE=','Pam','Kary','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1024','96cb5c841f56baf0cf04b6d9a566379c75f094936781e2b679cc1c5ce136846c','aTKni5+fQmRwo5EdIOpy/R67IQIyO0Z5gvJFNw1ZnXo=','Graig','Constant','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1025','b0a4c1a60c995a9ec49edbe8f490c2b7e4a470c8134c39ab9e804bafc41719ff','HZwTrQnyrRn44xiOcAzgz38rD1HTkJpTM4lub7t+Kd4=','Noble','Berryhill','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1026','5bdea2022e1c56b96e6abfbf28e2657bf728c119cf5b4c33257b320ff284f40a','/yj/g1Io7MD7XBE+zBYFFTZ31z7Y5K9erhW4wgm/vgY=','Leigh','Usher','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1027','5c0c952ba35127f8a5d61fddff238983526d9df3fbdccd2287cda5e5d0f076b2','0hXBcCx3Q3PrN6vW9DQEbnem03D0m0z9pECDnerHf/w=','Normand','Snowden','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('A1028','de6ae284afac2bbc2faedbb2e7d10676d972e0599ff033212b101f18c9ae2fdd','mRumRJJqTnh2CrlNIExy1DB2ybog15Sf7qCQsQD64ik=','Normand','Molitor','Administrator');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1029','93f0cefece85cc2801847e99ff8d715f2fa670479a4c15e46b121ac805faa114','zfKTBMS3eVyBpJ8U3PfwJvmMnT7QR1CtFNrUGsungSc=','Ethelyn','Velarde','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1030','4b8c8f554de907e26b792901f50b40eda8e9b9cfd856ac05f58c6204ed88984a','Obd/0lnU2P4vf+t5gi+ENBaxc5AuWGrgydpCAUmMWGY=','Judson','Matte','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1031','6a5a874744d873aab00102155041c65cfbdc52ffd68a3ca79123d038862d037d','RQ34x+4Bhzz0UvW1U5VMNeC+mc01bRZm1ULYq8Oaaec=','Gus','Ahmad','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1032','4c7555e902245b334c65121810f939c557a45a0d851b8d30d2ff1c5a5adeeb03','TNpr3cDE2vyl7W7Fkj7QZF97gP8nrPVwE7STTwpRrGw=','Mithcel','Bodin','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('A1033','2a143e6b30289bc5e0bc279cc1bb3611a39c658af0549664d2b56f83e3bf9bc6','2tdDjypVT03YpB2Mksv9rNJJ3Mk5Ar/9TWYd7SJDrJg=','Dane','Lagarde','Administrator');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('A1034','9e4aa33e36b44b9ec801d24304d12e860a0a3147ccd58b27327ae6a0f3da17c2','vQ5/KTwsVYPRHQcEPRv+h3W1tkPHWQb80U0F3Igc/+k=','Jone','Marques','Administrator');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('A1035','1adcfeb6cdfe113bff32f723bef4f362da0b2697a0174b76982a9288485d4c3a','b3wv4KjUpPbFJP/A6lt0IZmgozuYqFkyhY2ayo44kjI=','Joi','Danna','Administrator');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1036','eec9ce4684d59d0a5aaedd93d1ea619e818bf2e0b621bd6b3f9f50721e112e74','BsQa32mpCR3H+XdqT/z+5gxCo3x4atNmFRU9jsSn104=','Arlene','Hammet','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1037','b7d5f2aaa59dba42659c5066f5518cd0efc20edd255e7d2407eaaefe5a3f15da','7PeEVy6My0BvymdxoCXtfQeytokD4APMPXTj0JoNVKA=','Leah','Siewert','Driver');
Insert into PRCS251E.EMPLOYEES (EMPLOYEE_ID,EMPLOYEE_HASHED_PASSWORD,PASSWORD_SALT,FIRST_NAME,LAST_NAME,JOB_ROLE) values ('D1038','baddcf3c484723a92df0960342c96d90f736222c76d5cea2abc64ce331018318','Mh5ALS/Clv/lHYSu/xfX76wtTT+D0AeXnmO/qGEOWLc=','Michele','Williams','Driver');
--------------------------------------------------------
--  DDL for Index EMPLOYEES_EMPLOYEE_ID_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "PRCS251E"."EMPLOYEES_EMPLOYEE_ID_PK" ON "PRCS251E"."EMPLOYEES" ("EMPLOYEE_ID") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;
--------------------------------------------------------
--  DDL for Trigger TRG_ARCHIVE_EMPLOYEES
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "PRCS251E"."TRG_ARCHIVE_EMPLOYEES" 
BEFORE DELETE ON employees FOR EACH ROW
BEGIN
    INSERT INTO employees_archive
        (employee_id, first_name, last_name, job_role)
    VALUES
        (:OLD.employee_id, :OLD.first_name, :OLD.last_name, :OLD.job_role);
END;
/
ALTER TRIGGER "PRCS251E"."TRG_ARCHIVE_EMPLOYEES" ENABLE;
--------------------------------------------------------
--  DDL for Trigger TRG_EMPLOYEE_INITALISE
--------------------------------------------------------

  CREATE OR REPLACE EDITIONABLE TRIGGER "PRCS251E"."TRG_EMPLOYEE_INITALISE" 
BEFORE INSERT ON employees FOR EACH ROW
BEGIN
    /* Check what the job role is and assign the correct employee prefix 
        Administrator/Driver (A/D) */
    IF :NEW.job_role = 'Driver' THEN
        :NEW.employee_id := 'D' || seq_employee_id.nextval;
    ELSIF :NEW.job_role = 'Administrator' THEN
        :NEW.employee_id := 'A' || seq_employee_id.nextval;
    ELSE
        RAISE_APPLICATION_ERROR(-2000, 'Could not recognise the job role.');
    END IF;
END;
/
ALTER TRIGGER "PRCS251E"."TRG_EMPLOYEE_INITALISE" ENABLE;
--------------------------------------------------------
--  Constraints for Table EMPLOYEES
--------------------------------------------------------

  ALTER TABLE "PRCS251E"."EMPLOYEES" ADD CONSTRAINT "EMPLOYEES_EMPLOYEE_ID_PK" PRIMARY KEY ("EMPLOYEE_ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE;
  ALTER TABLE "PRCS251E"."EMPLOYEES" MODIFY ("EMPLOYEE_HASHED_PASSWORD" CONSTRAINT "EMPLOYEES_EMPLOYEE_PASSWORD_NN" NOT NULL ENABLE);
  ALTER TABLE "PRCS251E"."EMPLOYEES" ADD CONSTRAINT "EMPLOYEES_FIRST_NAME_CHK_ALPHA" CHECK (REGEXP_LIKE(first_name, '^[A-Za-z-'']+$')) ENABLE;
  ALTER TABLE "PRCS251E"."EMPLOYEES" ADD CONSTRAINT "EMPLOYEES_FIRST_NAME_CHK_INITCAP" CHECK (first_name = INITCAP(first_name)) ENABLE;
  ALTER TABLE "PRCS251E"."EMPLOYEES" MODIFY ("FIRST_NAME" CONSTRAINT "EMPLOYEES_FIRST_NAME_NN" NOT NULL ENABLE);
  ALTER TABLE "PRCS251E"."EMPLOYEES" MODIFY ("JOB_ROLE" CONSTRAINT "EMPLOYEES_JOB_ROLE" NOT NULL ENABLE);
  ALTER TABLE "PRCS251E"."EMPLOYEES" ADD CONSTRAINT "EMPLOYEES_JOB_ROLE_CHK" CHECK (job_role IN ('Driver', 'Administrator', 'Manager')) ENABLE;
  ALTER TABLE "PRCS251E"."EMPLOYEES" MODIFY ("LAST_NAME" CONSTRAINT "EMPLOYEES_LAST_NAME" NOT NULL ENABLE);
  ALTER TABLE "PRCS251E"."EMPLOYEES" ADD CONSTRAINT "EMPLOYEES_LAST_NAME_CHK_ALPHA" CHECK (REGEXP_LIKE(last_name, '^[A-Za-z-'']+$')) ENABLE;
  ALTER TABLE "PRCS251E"."EMPLOYEES" ADD CONSTRAINT "EMPLOYEES_LAST_NAME_CHK_INITCAP" CHECK (last_name = INITCAP(last_name)) ENABLE;
  ALTER TABLE "PRCS251E"."EMPLOYEES" MODIFY ("PASSWORD_SALT" CONSTRAINT "EMPLOYEES_PASSWORD_SALT_NN" NOT NULL ENABLE);
